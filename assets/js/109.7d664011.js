(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{426:function(s,t,a){"use strict";a.r(t);var n=a(7),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"node中间层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#node中间层"}},[s._v("#")]),s._v(" node中间层")]),s._v(" "),t("h3",{attrs:{id:"一、总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、总结"}},[s._v("#")]),s._v(" 一、总结")]),s._v(" "),t("p",[s._v("1、node中间层作用：前端也是mvc，NodeJS之后，前端可以更加专注于视图层，而让更多的数据逻辑放在Node层处理  "),t("br")]),s._v(" "),t("p",[s._v("2、node中间层作用：当发现所有请求量太多应付不过来的时候就可以考虑做这样的分离，将处理页面渲染的请求分给另一个服务，挡在前面，自己只负责数据相关的请求。nodejs擅长处理io密集型任务，很适合做处理页面渲染的服务 "),t("br")]),s._v(" "),t("p",[s._v("3、node中间层作用：功能分离，减轻板块负担  "),t("br")]),s._v(" "),t("p",[s._v("4、善用学习网站（不只善用搜索引擎）：去菜鸟教程或者别的里面首页可以了解例如node.js的作用 "),t("br")]),s._v(" "),t("p",[s._v("5、node.js：部署在服务器上的js，可以部署一些高性能服务。 "),t("br")]),s._v(" "),t("p",[s._v("简单的说 Node.js 就是运行在服务端的 JavaScript。")]),s._v(" "),t("p",[s._v("Node.js 是一个基于Chrome JavaScript 运行时建立的一个平台。")]),s._v(" "),t("p",[s._v("Node.js是一个事件驱动I/O服务端JavaScript环境，基于Google的V8引擎，V8引擎执行Javascript的速度非常快，性能非常好。")]),s._v(" "),t("p",[s._v("如果你是一个前端程序员，你不懂得像PHP、Python或Ruby等动态编程语言，然后你想创建自己的服务，那么Node.js是一个非常好的选择。")]),s._v(" "),t("p",[s._v("Node.js 是运行在服务端的 JavaScript，如果你熟悉Javascript，那么你将会很容易的学会Node.js。")]),s._v(" "),t("p",[s._v("当然，如果你是后端程序员，想部署一些高性能的服务，那么学习Node.js也是一个非常好的选择。")]),s._v(" "),t("h3",{attrs:{id:"二、从nodejs搭建中间层再谈前后端分离"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、从nodejs搭建中间层再谈前后端分离"}},[s._v("#")]),s._v(" 二、从NodeJS搭建中间层再谈前后端分离")]),s._v(" "),t("p",[s._v("之前在知道创宇的项目中有用到过nodejs作中间层，当时还不太理解其背后真正的原因；后来在和一位学长交谈的过程中，也了解到蚂蚁金服也在使用类似的方法，使用nodejs作为中间层去请求真实后台的数据；之后人到北京，也见到现在的公司也在往nodejs后端方向靠拢。随着知识的增加，加之自己查阅资料，慢慢总结出了一些原理。")]),s._v(" "),t("h4",{attrs:{id:"从做微信小程序引发的思考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#从做微信小程序引发的思考"}},[s._v("#")]),s._v(" 从做微信小程序引发的思考")]),s._v(" "),t("p",[s._v("最近出于爱好，写了个音乐播放器的微信小程序（原本想用vue写的，后来因为公司业务原因，年后可能去做微信小程序，所以就换了前端技术栈）。示例：\n"),t("a",{attrs:{href:"https://github.com/xingbofeng/wx-audio",target:"_blank",rel:"noopener noreferrer"}},[s._v("wx-audio"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("后端出于性能和别的原因，提供的接口所返回的数据格式也许不太适合前端直接使用，前端所需的排序功能、筛选功能，以及到了视图层的页面展现，也许都需要对接口所提供的数据进行二次处理。这些处理虽可以放在前端来进行，但也许数据量一大便会浪费浏览器性能。因而现今，增加node端便是一种良好的解决方案。")]),s._v(" "),t("p",[s._v("在我的微信小程序demo的server端代码中，我通过http模块对真实后台（网易云音乐API）发起http请求，然后通过express模块搭建后端服务。\n发起请求：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("// http.js\nvar formatURL "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" require"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./formatURL.js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nvar http "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" require"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconst POSThttp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" function"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" new Promise"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("resolve, reject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("let")]),s._v(" body "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    // http模块拿到真实后台api的数据\n    http.get"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("formatURL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request.body.musicname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", function"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      res.on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'data'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        body "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'end'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        // 格式化\n        const "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          name,\n          audio: musicUrl,\n          page,\n          album: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            name: musicName,\n            picUrl,\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n          artists: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            name: singer,\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" JSON.parse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("body"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".result.songs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        const reply "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          name,\n          picUrl,\n          musicUrl,\n          page,\n          singer,\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        resolve"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reply"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmodule.exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" POSThttp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("p",[s._v("得到数据传回前端：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("var express "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" require"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nvar POSThttp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" require"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./POSThttp.js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nvar bodyParser "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" require"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'body-parser'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n// 使用body-parser解析post请求的参数，如果没有，req.body为undefined。\nvar app "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" express"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\napp.use"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bodyParser.json"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\napp.use"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bodyParser.urlencoded"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  extended: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\napp.post"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req, res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  POSThttp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".then"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res.send"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".catch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res.send"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\napp.listen"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'open wx-audio server successful!'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[s._v("这几十行代码也就实现了一个简单的中间层的demo，并做到了在中间层格式化参数，便于前端进行使用的过程。")]),s._v(" "),t("h4",{attrs:{id:"为什么需要中间层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要中间层"}},[s._v("#")]),s._v(" 为什么需要中间层？")]),s._v(" "),t("p",[s._v("其实这个问题，我认为跟面试常考的题：“为什么需要前后端分离？”是类似的，其原因可以归纳为以下几点：")]),s._v(" "),t("h4",{attrs:{id:"现今网站存在问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#现今网站存在问题"}},[s._v("#")]),s._v(" 现今网站存在问题")]),s._v(" "),t("p",[s._v("之前有向一位在百度有多年工作经验的老前辈交谈这类问题，我所提到的搜狐公司代码冗余、前后端耦合的问题，他是这么回答并且给予我这样的建议：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s1.ax1x.com/2022/03/07/brcSqP.png",alt:"brcSqP.png"}})]),s._v(" "),t("p",[s._v("其实，提炼出来，现今大公司的老项目（包括百度、搜狐等公司所采用的后端渲染等），或多或少都会存在这样的一些 问题 ：")]),s._v(" "),t("p",[s._v("前端代码越来越复杂"),t("br"),s._v("\n前后端依旧高度耦合"),t("br"),s._v("\n无法良好的支持跨终端"),t("br")]),s._v(" "),t("h4",{attrs:{id:"前辈们提出的解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前辈们提出的解决方案"}},[s._v("#")]),s._v(" 前辈们提出的解决方案")]),s._v(" "),t("p",[s._v("参考"),t("a",{attrs:{href:"https://2014.jsconfchina.com/slides/herman-taobaoweb/index.html#/",target:"_blank",rel:"noopener noreferrer"}},[s._v(" 淘宝前后端分离解决方案"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("前端代码越来越复杂，我们希望尽可能地减少工作量，开始使用类似MV*的分层结构，使前端后分离成为必要。"),t("br"),s._v("\n前端需要处理更多的工作，希望有权操控View，Router（如：SPA的尝试）"),t("br"),s._v("\n各种终端设备的兴起，需要我们把页面适配到更多的地方。"),t("br")]),s._v(" "),t("p",[s._v("开始：我们所尝试的CLIENT-SIDE MV* 框架，后端暴露数据接口、处理业务逻辑，前端接收数据、处理渲染逻辑。"),t("br")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("关于MVC的定义：\n\nMVC是一种设计模式，它将应用划分为3个部分：数据（模型）、展现层（视图）和用户交互（控制器）。换句话说，一个事件的发生是这样的过程：\n　　"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". 用户和应用产生交互。\n　　"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". 控制器的事件处理器被触发。\n　　"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". 控制器从模型中请求数据，并将其交给视图。\n　　"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". 视图将数据呈现给用户。\n我们不用类库或框架就可以实现这种MVC架构模式。关键是要将MVC的每部分按照职责进行划分，将代码清晰地分割为若干部分，并保持良好的解耦。这样可以对每个部分进行独立开发、测试和维护。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://s1.ax1x.com/2022/03/07/brcrzd.png",alt:"brcrzd.png"}})]),s._v(" "),t("p",[s._v("但这样的方式仍旧存在问题：")]),s._v(" "),t("h5",{attrs:{id:"各层职责重叠"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#各层职责重叠"}},[s._v("#")]),s._v(" 各层职责重叠")]),s._v(" "),t("p",[s._v("Client-side Model 是 Server-side Model 的加工"),t("br"),s._v("\nClient-side View 跟 Server-side是 不同层次的东西"),t("br"),s._v("\nClient-side的Controller 跟 Sever-side的Controller 各搞各的"),t("br"),s._v("\nClient-side的Route 但是 Server-side 可能没有"),t("br")]),s._v(" "),t("h5",{attrs:{id:"性能问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#性能问题"}},[s._v("#")]),s._v(" 性能问题")]),s._v(" "),t("p",[s._v("渲染，取值都在客户端进行，有性能的问题"),t("br"),s._v("\n需要等待资源到齐才能进行，会有短暂白屏与闪动"),t("br"),s._v("\n在移动设备低速网路的体验奇差无比"),t("br")]),s._v(" "),t("h5",{attrs:{id:"重用问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重用问题"}},[s._v("#")]),s._v(" 重用问题")]),s._v(" "),t("p",[s._v("模版无法重用，造成维护上的麻烦与不一致"),t("br"),s._v("\n逻辑无法重用，前端的校验后端仍须在做一次"),t("br"),s._v("\n路由无法重用，前端的路由在后端未必存在"),t("br")]),s._v(" "),t("h5",{attrs:{id:"跨终端问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#跨终端问题"}},[s._v("#")]),s._v(" 跨终端问题")]),s._v(" "),t("p",[s._v("业务太靠前，导致不同端重复实现"),t("br"),s._v("\n逻辑太靠前，造成维护上的不易"),t("br")]),s._v(" "),t("h5",{attrs:{id:"渲染都在客户端-模版无法重用-seo实现-麻烦"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#渲染都在客户端-模版无法重用-seo实现-麻烦"}},[s._v("#")]),s._v(" 渲染都在客户端，模版无法重用，SEO实现 麻烦")]),s._v(" "),t("h4",{attrs:{id:"nodejs作为中间层的全栈开发方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nodejs作为中间层的全栈开发方案"}},[s._v("#")]),s._v(" NodeJS作为中间层的全栈开发方案")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s1.ax1x.com/2022/03/07/br2Aun.png",alt:"br2Aun.png"}})]),s._v(" "),t("p",[s._v("我们使用Node层："),t("br")]),s._v(" "),t("p",[s._v("转发数据，串接服务"),t("br"),s._v("\n路由设计，控制逻辑"),t("br"),s._v("\n渲染页面，体验优化"),t("br"),s._v("\n中间层带来的性能问题，在异步ajax转成同步渲染过程中得到平衡"),t("br"),s._v("\n更多的可能"),t("br"),s._v("\n其实更为重要的是，对于前端来说，NodeJS的学习成本是相当低的：我们无需学习一门新的语言，就能做到以前开发帮我们做的事情，一切都显得那么自然。"),t("br")]),s._v(" "),t("p",[s._v("技术在不断变化中，唯有跟上技术革新的浪潮，才能不被时代所淘汰，不管是人还是企业。"),t("br")]),s._v(" "),t("h3",{attrs:{id:"三、node做中间层是什么意思-能具体详说么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、node做中间层是什么意思-能具体详说么"}},[s._v("#")]),s._v(" 三、node做中间层是什么意思，能具体详说么？")]),s._v(" "),t("p",[s._v("问题：")]),s._v(" "),t("p",[s._v("没接触过node，经常看文章说node做中间层，不知道具体指什么意思？比如在程序中解决了什么问题，如果说解决了渲染问题，那也是页面端，前端框架已经解决了，难道说是后端渲染前端框架，然后整个塞到前端吗？")]),s._v(" "),t("p",[s._v("解答：")]),s._v(" "),t("p",[s._v("很多项目中后端应用往往不止一个服务，而是一群各司其职的服务，比如nginx的存在就是因为服务器上运行着多个服务，而不同的网络请求由不同的服务处理，需要在这些服务前假设一层nginx做为代理，将请求分发给不同的服务，nginx在这里的角色就相当于中间层。")]),s._v(" "),t("p",[s._v("对于一个比较复杂的web站点，页面中的请求通常分为两种，请求页面与请求数据(ajax)。如果后端是个单体应用，当发现所有请求量太多应付不过来的时候就可以考虑做这样的分离，将处理页面渲染的请求分给另一个服务，挡在前面，自己只负责数据相关的请求。nodejs擅长处理io密集型任务，很适合做处理页面渲染的服务，于是很多人选择了nodejs。淘宝也是类似的架构，据说现在所有淘宝的页面都是由node服务渲染的。")]),s._v(" "),t("p",[s._v("讲道理就是用nodejs做静态资源管理和请求转发。\n做到后端只管数据接口，前端负责路由，静态资源。")]),s._v(" "),t("p",[s._v("加了node的中间层，可以让前端处理view层和control层，后端只负责处理model层。前后端分离比较彻底，分工更明确一些吧。")]),s._v(" "),t("p",[s._v("另外就是有些框架在服务器不是node的时候SEO比较难做。加了node中间层后比较好做SEO")]),s._v(" "),t("p",[s._v("node就是链状执行")]),s._v(" "),t("p",[s._v("请求接收 -> 中间件1 -> 中间件2 -> ... 中间件n ... -> 返回")]),s._v(" "),t("p",[s._v("中间件就是某一个处理操作")])])}),[],!1,null,null,null);t.default=r.exports}}]);